<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Molecular DNA Macro Files - Molecular DNA</title> <link rel="shortcut icon" href="/molecular-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/molecular-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/molecular-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/molecular-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Molecular DNA Macro Files | Molecular DNA</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Molecular DNA Macro Files" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <meta property="og:description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <link rel="canonical" href="https://geant4-dna.github.io/molecular-docs/docs/overview/macro-anatomy" /> <meta property="og:url" content="https://geant4-dna.github.io/molecular-docs/docs/overview/macro-anatomy" /> <meta property="og:site_name" content="Molecular DNA" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Molecular DNA Macro Files" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4.","headline":"Molecular DNA Macro Files","url":"https://geant4-dna.github.io/molecular-docs/docs/overview/macro-anatomy"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://geant4-dna.github.io/molecular-docs/" class="site-title lh-tight"> Molecular DNA </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/overview" class="nav-list-link">Overview</a><ul class="nav-list "><li class="nav-list-item active"><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/macro-anatomy" class="nav-list-link active">Molecular DNA Macro Files</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/geometry-model" class="nav-list-link">Geometry Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/physics-model.html" class="nav-list-link">Physics Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/results-and-analysis" class="nav-list-link">Results and Analysis</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/damage-model" class="nav-list-link">Damage Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/chemistry-model.html" class="nav-list-link">Chemistry Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/configuration" class="nav-list-link">Configuration Glossary</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library" class="nav-list-link">Geometry Library</a><ul class="nav-list "><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/fractal-dna" class="nav-list-link">Fractal DNA Package</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/geometry-placements" class="nav-list-link">Geometry Placements</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/dna-placements" class="nav-list-link">DNA Placements</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/examples" class="nav-list-link">Examples</a><ul class="nav-list "><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/parameter-study" class="nav-list-link">Parameter Study</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/bacterial-cell" class="nav-list-link">Bacterial Cell</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/human-cell" class="nav-list-link">Human Cell</a></li></ul></li><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/source.html" class="nav-list-link">Running from Source</a></li><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/publications.html" class="nav-list-link">Publications</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Molecular DNA" aria-label="Search Molecular DNA" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/geant4-dna/molecular-docs" class="site-button" > Molecular DNA on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="http://geant4-dna.in2p3.fr/index.html" class="site-button" > The Geant4-DNA Project </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/overview">Overview</a></li> <li class="breadcrumb-nav-list-item"><span>Molecular DNA Macro Files</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="molecular-dna-macro-files"> <a href="#molecular-dna-macro-files" class="anchor-heading" aria-labelledby="molecular-dna-macro-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Molecular DNA Macro Files </h1> <p>Macro files define simulations in Geant4. Molecular DNA contains a number of additional commands that allow DNA damage simulations to take place. The full list of commands is written in <a href="/molecular-docs/docs/overview/configuration">Configuration</a>.</p> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#a-basic-macro-file" id="markdown-toc-a-basic-macro-file">A Basic Macro File</a></li> <li><a href="#set-up-the-world" id="markdown-toc-set-up-the-world">Set up the world</a></li> <li><a href="#set-up-the-geometry" id="markdown-toc-set-up-the-geometry">Set Up the Geometry</a></li> <li><a href="#define-the-chromosomes" id="markdown-toc-define-the-chromosomes">Define the Chromosomes</a></li> <li><a href="#set-up-the-damage-model" id="markdown-toc-set-up-the-damage-model">Set up the Damage Model</a></li> <li><a href="#set-up-the-beam" id="markdown-toc-set-up-the-beam">Set up the beam</a></li> <li><a href="#set-up-analysis-rules" id="markdown-toc-set-up-analysis-rules">Set up analysis rules</a></li> <li><a href="#run-the-simulation" id="markdown-toc-run-the-simulation">Run the simulation</a></li> </ol> <h2 id="a-basic-macro-file"> <a href="#a-basic-macro-file" class="anchor-heading" aria-labelledby="a-basic-macro-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A Basic Macro File </h2> <p>Let’s start with a basic macro file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># First off, we set the size of the world
/world/worldSize 3 um

# Next we define the geometry
/dnageom/placementSize 50 50 50 nm
/dnageom/placementVolume turn geometries/1strand_50nm_turn.txt
/dnageom/placementVolume turntwist geometries/1strand_50nm_turn.txt true
/dnageom/placementVolume straight geometries/1strand_50nm_straight.txt

/dnageom/fractalScaling 50 50 50 nm
/dnageom/definitionFile geometries/hilbert1.txt

# We define our "chromosomes"
/chromosome/add cell sphere 200 0 0 0 nm

# Geometry related damage parameters
/dnageom/radicalKillDistance 4 nm
/dnageom/interactionDirectRange 6 angstrom

# We define the damage model
/dnadamage/directDamageLower 17.5 eV
/dnadamage/directDamageUpper 17.5 eV

/dnadamage/indirectOHBaseChance 1.0
/dnadamage/indirectOHStrandChance 0.4
/dnadamage/inductionOHChance 0.00

/dnadamage/indirectHBaseChance 1.0
/dnadamage/indirectHStrandChance 0.4
/dnadamage/inductionHChance 0.00

/dnadamage/indirectEaqBaseChance 1.0
/dnadamage/indirectEaqStrandChance 0.4
/dnadamage/inductionEaqChance 0.00

# And then we initialize our run
/run/initialize

# The General Particle Source is used to define a beam
/gps/particle proton
/gps/ang/type iso
/gps/energy 100 keV
/gps/pos/type Point
/gps/pos/centre 51 51 51 nm

# Set any analysis parameters
/analysisDNA/fileName my_file.root

# And the simulation can run!
/run/beamOn 1
</code></pre></div></div> <p>That’s a lot to digest. But we can break down the macro file into a few components:</p> <ol> <li>Set up the world</li> <li>Define the geometry</li> <li>Define the regions of interest (chromosomes)</li> <li>Define the damage model</li> <li>Set up the beam</li> <li>Set any analysis rules</li> <li>Run the simulation!</li> </ol> <h2 id="set-up-the-world"> <a href="#set-up-the-world" class="anchor-heading" aria-labelledby="set-up-the-world"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up the world </h2> <p>The first command to run is to set the size of the world. The simulation runs in a square world and you can set the side length as below:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/world/worldSize 3 um
</code></pre></div></div> <p>The world is entirely made of water unless you also specify a cell (by its semi-major axes).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/cell/radiusSize 1 1 0.5 um
</code></pre></div></div> <p>Cells modify the default behavoiur by placing a water containing cell into a vacuum-filled world.</p> <p class="text-center"><img src="/molecular-docs/assets/images/world.svg" alt="World with and without /cell command" /></p> <h2 id="set-up-the-geometry"> <a href="#set-up-the-geometry" class="anchor-heading" aria-labelledby="set-up-the-geometry"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set Up the Geometry </h2> <p>There are two important notions when we define the geometry, <em>placement definitions</em> and the <em>geometry definition</em>, often called the <em>fractal definition</em> as it is often seeded with a fractal.</p> <ul> <li><em>Placement Definition</em> defines the small scale structure of the simulation.</li> <li><em>Geometry Definition</em> defines the large scale structure of the simulation.</li> </ul> <p>This is illustrated below, where turned and straight segments are used to build a horse-shoe shape:</p> <p class="text-center"><img src="/molecular-docs/assets/images/placements.png" alt="Placements for DNA Geometries" /></p> <p>So how does all this work? Let’s break down the definitions above:</p> <p>The first things we define are the sizes of our placement volumes. Here we use 50 nm side length cubes, but these can be rectangular prisms of any shape.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/placementSize 50 50 50 nm
</code></pre></div></div> <p>In this example there are three placement definitions for a straight section, a turned section, and a turned with a 90˚ twist section.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/placementVolume turn geometries/1strand_50nm_turn.txt
/dnageom/placementVolume turntwist geometries/1strand_50nm_turn.txt true
/dnageom/placementVolume straight geometries/1strand_50nm_straight.txt
</code></pre></div></div> <p>These are referenced by the their names turn, straight and turntwist in the geometry definition file which is loaded as follows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/definitionFile geometries/hilbert1.txt
</code></pre></div></div> <p>This particular file handles the space in integer units, so that we can scale them using the command, which allows the definition file to be scaled to the size of the placement volumes we use in this example.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/fractalScaling 50 50 50 nm
</code></pre></div></div> <h2 id="define-the-chromosomes"> <a href="#define-the-chromosomes" class="anchor-heading" aria-labelledby="define-the-chromosomes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Define the Chromosomes </h2> <p>In Molecular DNA, you can think of chromosomes as <em>regions of interest</em> for analysis. Currently, cylindrical, spherical and elliptical chromosome shapes can be defined, which are mapped onto the placement volumes defined by the large scale geometry.</p> <p>The below image shows, for example how two chromosomes can be defined to yield two regions of interest, overlaid on the grid which defines the overall geometry. Where chromosome regions overlap, energy depositions will be recorded in both.</p> <p class="text-center"><img src="/molecular-docs/assets/images/chromosomes.svg" alt="Two chromosomes in 2-D" width="300px" /></p> <p>Importantly, the DNA geometry is only placed inside chromosomes. Using this, a square geometry can be coerced to a circular form, by placing a spherical chromosome as we do here:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/chromosome/add cell sphere 200 0 0 0 nm
</code></pre></div></div> <h2 id="set-up-the-damage-model"> <a href="#set-up-the-damage-model" class="anchor-heading" aria-labelledby="set-up-the-damage-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up the Damage Model </h2> <p>A number of parameters are used to determine how DNA damage works in the simulation. The first of these determine how the geometry in particular influences the simulation.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/radicalKillDistance 4 nm
/dnageom/interactionDirectRange 6 angstrom
</code></pre></div></div> <p>The <em>Radical Kill Distance</em> tells the simulation to kill all chemistry tracks further than 4nm from the DNA. This parameter is an implicit bound on scavenging. It basically assumes all chemical radicals that need to diffuse 4nm to react with the DNA will be scavenged before they are able to interact chemically with the DNA molecule.</p> <p>The <em>Direct Interaction Range</em> describes to what radius direct (physics-driven) energy depositions should be ascribed to a DNA molecule. Here, only energy depositions with 6Å can contribute a direct strand break.</p> <p>The next part of the damage model handles how direct strand breaks are calculated. The below snippet defines a step function where a cumulative deposition of 17.5eV or more in one event will cause a break.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnadamage/directDamageLower 17.5 eV
/dnadamage/directDamageUpper 17.5 eV
</code></pre></div></div> <p>The lower and upper values here describe a broken linear function where:</p> <ul> <li>Energy Deposition below directDamageLower never causes a break</li> <li>Energy Deposition above directDamageUpper always causes a break</li> <li>Between these bounds, the likelihood of a break rises uniformly</li> </ul> <p>An example of this, for a lower bound of 5eV and an upper bound of 37.5eV is shown below</p> <p class="text-center"><img src="/molecular-docs/assets/images/break-chance.png" alt="Linearly increasing damage likelihood for physical damage" width="300px" /></p> <p>Next, we define the likelihood of chemical damage occurring for different reactions as below:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnadamage/indirectOHBaseChance 1.0
/dnadamage/indirectOHStrandChance 0.4
/dnadamage/inductionOHChance 0.00
</code></pre></div></div> <p>Indirect damage here is what is typically discussed in most papers, it is the likelihood of a chemical reaction occurring between either OH (in this case) and either a base or strand molecule. A lot of research only considers reactions between radicals and strands as leading to strand breaks, and this simulation considers that all reactions between a strand and a radical cause a break.</p> <p>On the other hand, it’s rarely considered that an interaction between a radical and a base can lead to a strand break. If, for whatever reason, you want to model this, you can use the induction chance. This is the probability that base damage leads to a strand break.</p> <p>For most simulations, all that is important are the Radical+Strand break chances, which are set by:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnadamage/indirectOHStrandChance 0.4
/dnadamage/indirectHStrandChance 0.4
/dnadamage/indirectEaqStrandChance 0.4
</code></pre></div></div> <p>for the <sup>•</sup>OH, H<sup>+</sup> and e<sub>aq</sub> radicals respectively.</p> <h2 id="set-up-the-beam"> <a href="#set-up-the-beam" class="anchor-heading" aria-labelledby="set-up-the-beam"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up the beam </h2> <p>The simulation allows the Geant4 General Particle Source be used to define the beam. You can read the documentation <a href="https://geant4-userdoc.web.cern.ch/UsersGuides/ForApplicationDeveloper/html/GettingStarted/generalParticleSource.html">here</a>.</p> <p>The source here defines a 100keV proton point source emitting isotropically.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># The General Particle Source is used to define a beam
/gps/particle proton
/gps/ang/type iso
/gps/energy 100 keV
/gps/pos/type Point
/gps/pos/centre 51 51 51 nm
</code></pre></div></div> <h2 id="set-up-analysis-rules"> <a href="#set-up-analysis-rules" class="anchor-heading" aria-labelledby="set-up-analysis-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set up analysis rules </h2> <p>The commands under analysisDNA allow the analysis to be modified. Notably, you’ll want to set the output file name:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/analysisDNA/fileName my_file.root
</code></pre></div></div> <h2 id="run-the-simulation"> <a href="#run-the-simulation" class="anchor-heading" aria-labelledby="run-the-simulation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Run the simulation </h2> <p>Particles can be fired using the <code class="language-plaintext highlighter-rouge">/run/beamOn</code> command. If you haven’t already run <code class="language-plaintext highlighter-rouge">/run/initialize</code>, the initialisation process will also occur here. Be advised that this can take many hours to build a complex DNA geometry due to how the simulation has been designed and the current constraints of Geant4 as it optimises navigation. It is advised that a test on a small geometry is run before moving to a human cell-sized geometry.</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Built using <a href="https://github.com/pmarsceill/just-the-docs">Just The Docs</a>.</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
