<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Geometry Model - Molecular DNA</title> <link rel="shortcut icon" href="/molecular-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/molecular-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/molecular-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/molecular-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Geometry Model | Molecular DNA</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Geometry Model" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <meta property="og:description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <link rel="canonical" href="https://geant4-dna.github.io/molecular-docs/docs/overview/geometry-model" /> <meta property="og:url" content="https://geant4-dna.github.io/molecular-docs/docs/overview/geometry-model" /> <meta property="og:site_name" content="Molecular DNA" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Geometry Model" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4.","headline":"Geometry Model","url":"https://geant4-dna.github.io/molecular-docs/docs/overview/geometry-model"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://geant4-dna.github.io/molecular-docs/" class="site-title lh-tight"> Molecular DNA </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/overview" class="nav-list-link">Overview</a><ul class="nav-list "><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/macro-anatomy" class="nav-list-link">Molecular DNA Macro Files</a></li><li class="nav-list-item active"><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/geometry-model" class="nav-list-link active">Geometry Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/physics-model.html" class="nav-list-link">Physics Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/results-and-analysis" class="nav-list-link">Results and Analysis</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/damage-model" class="nav-list-link">Damage Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/chemistry-model.html" class="nav-list-link">Chemistry Model</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/overview/configuration" class="nav-list-link">Configuration Glossary</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library" class="nav-list-link">Geometry Library</a><ul class="nav-list "><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/fractal-dna" class="nav-list-link">Fractal DNA Package</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/geometry-placements" class="nav-list-link">Geometry Placements</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/geometry-library/dna-placements" class="nav-list-link">DNA Placements</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://geant4-dna.github.io/molecular-docs/docs/examples" class="nav-list-link">Examples</a><ul class="nav-list "><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/parameter-study" class="nav-list-link">Parameter Study</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/bacterial-cell" class="nav-list-link">Bacterial Cell</a></li><li class="nav-list-item "><a href="https://geant4-dna.github.io/molecular-docs/docs/examples/human-cell" class="nav-list-link">Human Cell</a></li></ul></li><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/source.html" class="nav-list-link">Running from Source</a></li><li class="nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/publications.html" class="nav-list-link">Publications</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Molecular DNA" aria-label="Search Molecular DNA" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/geant4-dna/molecular-docs" class="site-button" > Molecular DNA on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="http://geant4-dna.in2p3.fr/index.html" class="site-button" > The Geant4-DNA Project </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://geant4-dna.github.io/molecular-docs/docs/overview">Overview</a></li> <li class="breadcrumb-nav-list-item"><span>Geometry Model</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="geometry-model"> <a href="#geometry-model" class="anchor-heading" aria-labelledby="geometry-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Geometry Model </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#design-principal" id="markdown-toc-design-principal">Design Principal</a></li> <li><a href="#dna-placements" id="markdown-toc-dna-placements">DNA Placements</a> <ol> <li><a href="#specifying-molecule-sizes" id="markdown-toc-specifying-molecule-sizes">Specifying Molecule Sizes</a></li> <li><a href="#adding-multiple-chains" id="markdown-toc-adding-multiple-chains">Adding multiple chains</a></li> <li><a href="#defining-dna-placements" id="markdown-toc-defining-dna-placements">Defining DNA Placements</a></li> <li><a href="#considerations-for-base-pairs" id="markdown-toc-considerations-for-base-pairs">Considerations for Base Pairs</a></li> </ol> </li> <li><a href="#geometry-placements" id="markdown-toc-geometry-placements">Geometry Placements</a></li> <li><a href="#physics-and-chemistry-considerations" id="markdown-toc-physics-and-chemistry-considerations">Physics and Chemistry Considerations</a> <ol> <li><a href="#physics-cross-sections" id="markdown-toc-physics-cross-sections">Physics Cross Sections</a></li> <li><a href="#parallel-worlds-for-physics-and-chemistry" id="markdown-toc-parallel-worlds-for-physics-and-chemistry">Parallel Worlds for Physics and Chemistry</a></li> </ol> </li> </ol> <h2 id="design-principal"> <a href="#design-principal" class="anchor-heading" aria-labelledby="design-principal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design Principal </h2> <p>Molecular DNA was made to make it easy to define a DNA geometry, and then place it repeatedly to model a complex geometry at large scales, as below.</p> <p class="text-center"><img src="/molecular-docs/assets/images/placements.png" alt="Placements for DNA Geometries" /></p> <p>There are two important notions when we define the geometry, <em>placement definitions</em> and the <em>geometry defintion</em>, often called the <em>fractal definition</em> as it is often seeded with a fractal.</p> <ul> <li><em>Placement Definition</em> defines the small scale structure of the simulation.</li> <li><em>Geometry Definition</em> defines the large scale structure of the simulation.</li> </ul> <p>Some examples of how to make these files are available on <a href="https://github.com/natl/fractaldna">Github</a>, and examples can be downloaded from the <a href="/molecular-docs/docs/geometry-library">Geometry Library</a></p> <h2 id="dna-placements"> <a href="#dna-placements" class="anchor-heading" aria-labelledby="dna-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DNA Placements </h2> <p>DNA Placements are the low level building block of the DNA geometry and show how the DNA sits in a given prism.</p> <p>A simple example of this is below, containing 14 base pairs (grey), alongside the sugar (red) and phosphate (yellow) molecules in the chain.</p> <p class="text-center"><img src="/molecular-docs/assets/images/placement-example.png" alt="Example DNA placement" width="400px" /></p> <p>These files are specified as either 11 or 14 column ASCII text files with the schema below:</p> <ul> <li>MOLECULE_NAME - Name of the molecule</li> <li>SHAPE <em>Optional</em> - Shape of the molecule (Sphere or Ellipse)</li> <li>CHAIN_ID - Index for the chain</li> <li>STRAND_ID - Index for the strand (either left or right side of the DNA molecule)</li> <li>BP_INDEX - Index of the base pair in the volume (per chain)</li> <li>SIZE_X <em>Optional</em> - semi-major x axis of ellipse (Å)</li> <li>SIZE_Y <em>Optional</em> - semi-major y axis of ellipse (Å)</li> <li>SIZE_Z <em>Optional</em> - semi-major z axis of ellipse (Å)</li> <li>POS_X - x position in volume (Å)</li> <li>POS_Y - y position in volume (Å)</li> <li>POS_Z - z position in volume (Å)</li> <li>ROT_X - rotation around the X-axis</li> <li>ROT_Y - rotation around the Y-axis</li> <li>ROT_Z - Rotation around the Z-axis</li> </ul> <p>Distances are specified in Angstrom, while angles are specified in radians (and correspond to the three Euler angles).</p> <h3 id="specifying-molecule-sizes"> <a href="#specifying-molecule-sizes" class="anchor-heading" aria-labelledby="specifying-molecule-sizes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Specifying Molecule Sizes </h3> <p>The molecule size columns are optional, as they can either fall back onto the default sizes or be set to custom sizes in the macro definition via:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/useCustomMoleculeSizes
/dnageom/moleculeSize name x y z units
</code></pre></div></div> <p>Note that molecule name matches are case insensitive.</p> <p>The default molecule names and sizes are:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Molecule Name</th> <th style="text-align: right">X semi-major axis (Å)</th> <th style="text-align: right">Y semi-major axis (Å)</th> <th style="text-align: right">Z semi-major axis (Å)</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">phosphate</td> <td style="text-align: right">2.282354</td> <td style="text-align: right">2.282354</td> <td style="text-align: right">2.282354</td> </tr> <tr> <td style="text-align: left">sugar</td> <td style="text-align: right">2.632140</td> <td style="text-align: right">2.632140</td> <td style="text-align: right">2.632140</td> </tr> <tr> <td style="text-align: left">guanine</td> <td style="text-align: right">3.631503</td> <td style="text-align: right">3.799953</td> <td style="text-align: right">1.887288</td> </tr> <tr> <td style="text-align: left">cytosine</td> <td style="text-align: right">3.597341</td> <td style="text-align: right">3.066331</td> <td style="text-align: right">1.779361</td> </tr> <tr> <td style="text-align: left">adenine</td> <td style="text-align: right">3.430711</td> <td style="text-align: right">3.743504</td> <td style="text-align: right">1.931958</td> </tr> <tr> <td style="text-align: left">thymine</td> <td style="text-align: right">4.205943</td> <td style="text-align: right">3.040448</td> <td style="text-align: right">2.003359</td> </tr> <tr> <td style="text-align: left">histone</td> <td style="text-align: right">25</td> <td style="text-align: right">25</td> <td style="text-align: right">25</td> </tr> </tbody> </table></div> <h3 id="adding-multiple-chains"> <a href="#adding-multiple-chains" class="anchor-heading" aria-labelledby="adding-multiple-chains"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding multiple chains </h3> <p>A simple way to increase the density of DNA in simulations is to place multiple chains of DNA in each placement volume. Multiple ‘chains’ can be placed in the one placement volume as shown below, provide that they each have a different chain_id in the data file. Here, we show graphically what a 1-chain and 4-chain placement volume could look like.</p> <p class="text-center"><img src="/molecular-docs/assets/images/1-strand.png" alt="1 DNA Chain Placement Volume" width="200px" /> <img src="/molecular-docs/assets/images/4-strand.png" alt="4 DNA Chains Placement Volume" width="200px" /></p> <p>The simulation platform supports 1, 4 and 8 chains. It will join chains together correctly even when placement volumes are rotated along the lines of the image shown below.</p> <p class="text-center"><img src="/molecular-docs/assets/images/two-strand-index-counting.png" alt="Index Counting" width="200px" /></p> <h3 id="defining-dna-placements"> <a href="#defining-dna-placements" class="anchor-heading" aria-labelledby="defining-dna-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining DNA Placements </h3> <p>Placement files should be defined with either of the following two (space seperated) schemas:</p> <p><em>Specifying Size for every molecule</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME SHAPE CHAIN_ID STRAND_ID BP_INDEX SIZE_X SIZE_Y SIZE_Z POS_X POS_Y POS_Z ROT_X ROT_Y ROT_Z
</code></pre></div></div> <p><em>Not specifying size for every molecule</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME CHAIN_ID STRAND_ID BP_INDEX POS_X POS_Y POS_Z ROT_X ROT_Y ROT_Z
</code></pre></div></div> <p>Spatial units are <em>angstroms</em>, angles are in <em>radians</em>. Molecule names cannot contain spaces.</p> <p>The program assumes that the file is ordered first by base pair, then strand, then chain as below, keeping the order Phosphate, Sugar then Base. Histones when specified can be placed anywhere in the file however (they are often at the start or end).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME          ... CHAIN_ID STRAND_ID BP_INDEX
Phosphate         0        0         0
Sugar             0        0         0
Base              0        0         0
Phosphate         0        1         0
Sugar             0        1         0
Base              0        1         0
Phosphate         0        0         1
Sugar             0        0         1
Base              0        0         1
Phosphate         0        1         1
Sugar             0        1         1
Base              0        1         1
Phosphate         0        0         2
Sugar             0        0         2
Base              0        0         2
Phosphate         0        1         2
Sugar             0        1         2
Base              0        1         2
Phosphate         1        0         1
Sugar             1        0         1
Base              1        0         1
</code></pre></div></div> <p>The order Phosphate - Sugar - Base must always be kept. Each chain is specified completely before a new chain starts, and base pair sections are specified in their entirety before a new base pair section is specified.</p> <p>This is done to enable the file to be read in such that their is a fixed distance between any molecule and its neighbours. This facilitates the cutting of certain shapes within Geant4 so that each shape can be represented with the maximum volume possible.</p> <p>The program will assume the neighbouring molecules for a given sugar, phosphate or base are:</p> <ul> <li>Base Pair, strand ID 0: Sugar at :-1, base at :+3, base at :-6</li> <li>Base Pair, strand ID 1: Sugar at :-1, base at :-3, base at :-6</li> <li>Sugar: Phosphate at L-1</li> <li>Phosphate: Sugar at L+5</li> </ul> <p>Once defined, a placement volume can be loaded using the following command:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/placementVolume name path twist
</code></pre></div></div> <p>For example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/placementVolume turntwist geometries/turned_twisted_solenoid_750.txt true
</code></pre></div></div> <h3 id="considerations-for-base-pairs"> <a href="#considerations-for-base-pairs" class="anchor-heading" aria-labelledby="considerations-for-base-pairs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Considerations for Base Pairs </h3> <p>When building the geometry, you’ll probably consider a base pair in an unrotated space and then rotate the base pair to produce the chain you desire, as well as the standard double helix.</p> <p>Our geometries have been built and tested with the primary axis of the double helix in a straight DNA segment being the Z-axis. Similarly, a base pair on its own is built so that its height (the 3.4Å-long axis) is the Z-axis. We rely on this assumption to know that, in a frame of reference prior to any rotation, a base pair should be roughly 3.4Å in height.</p> <p>This assumption is used to help stop molecule placements intersecting each other. If you are developing geometries alongside the Python package <a href="http://github.com/natl/fractaldna">FractalDNA</a>, these changes should be done automatically.</p> <h2 id="geometry-placements"> <a href="#geometry-placements" class="anchor-heading" aria-labelledby="geometry-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Geometry Placements </h2> <p>The Geometry Definition files describe how the DNA placements should be put into the simulation world.</p> <p>Often it will define tesselating cubes that join DNA together in a snake-like pattern, though it can also be used to place non-connected DNA elements (e.g. <a href="https://www.sciencedirect.com/science/article/abs/pii/S1120179718300346">this parameter study</a>).</p> <p>Three control parameters are useful when placing the geometry:</p> <ul> <li><code class="language-plaintext highlighter-rouge">/analysisDNA/fragmentGap 0</code> will treat all placements as seperate, preventing any joining between strands.</li> <li><code class="language-plaintext highlighter-rouge">/dnageom/setVoxelPlacementAnglesAsMultiplesOfPi</code> will load the Euler angles for placement volumes as multiples of pi.</li> <li><code class="language-plaintext highlighter-rouge">/dnageom/fractalScaling X Y Z nm</code> will scale the distances in the geometry file by the values specified. <ul> <li>e.g. <code class="language-plaintext highlighter-rouge">/dnageom/fractalScaling 1 1 1 nm</code> will mean that the geometry file is in units of nm.</li> </ul> </li> </ul> <p>The schema for the geometry placement files is as follows, with rotations being the Euler angles.</p> <ul> <li>IDX - placement index</li> <li>KIND - placement name (should correspond to a DNA volume definition)</li> <li>POS_X - X position (mm if not scaled)</li> <li>POS_Y - Y position (mm if not scaled)</li> <li>POS_Z - Z position (mm if not scaled)</li> <li>EUL_PSI - placement rotation (psi)</li> <li>EUL_THETA - placement rotation (theta)</li> <li>EUL_PHI - placement rotation (phi)</li> </ul> <p>An example file might look like this.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#IDX KIND POS_X POS_Y POS_Z EUL_PSI EUL_THETA EUL_PHI
0 straight 0.0 0.0 0.0 0.0 -0.0 0.0
1 turn 0.0 0.0 1.0 0.0 -0.0 1.57079632679
2 turn 0.0 1.0 1.0 -1.57079632679 1.57079632679 0
3 turntwist -0.0 1.0 0.0 3.14159265359 -0.0 0.0
4 turn 1.0 1.0 -0.0 -3.14159265359 -1.57079632679 0
5 turntwist 1.0 1.0 1.0 0.0 -0.0 -1.57079632679
6 turn 1.0 0.0 1.0 1.57079632679 1.57079632679 0
7 straight 1.0 0.0 -0.0 3.14159265359 -0.0 0.0
</code></pre></div></div> <p>And could be loaded like this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/dnageom/definitionFile /path/to/definition.txt # or another path
/dnageom/fractalScaling 50 50 50 nm  # scale each unit to 50 nm blocks
</code></pre></div></div> <h2 id="physics-and-chemistry-considerations"> <a href="#physics-and-chemistry-considerations" class="anchor-heading" aria-labelledby="physics-and-chemistry-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Physics and Chemistry Considerations </h2> <p>Molecular DNA is a means of allowing geometries to interact with the physics and chemistry of Geant4 in a reliable way for DNA damage.</p> <p>Most of this is done through the <a href="/molecular-docs/docs/overview/damage-model">damage model</a>, but there are some implementation details in the geometry model.</p> <h3 id="physics-cross-sections"> <a href="#physics-cross-sections" class="anchor-heading" aria-labelledby="physics-cross-sections"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Physics Cross Sections </h3> <p>Inside each molecule in DNA’s volume, we use the cross sections for that material rather than the cross section of water.</p> <p>Sometimes we shrink/cut these molecules in order to place them, which has an impact on the volume of the simulation which uses their cross-section, as below, where the red sugar and yellow phosphate molecules are cut so as not to overlap.</p> <p class="text-center"><img src="/molecular-docs/assets/images/dna-ogl.png" alt="Image of cut molecules for Geant4 Placement" width="350px" /></p> <p>This has a very minimal impact on the actual physics of the simulation as the regions occupied by DNA are so small compared to the water region.</p> <h3 id="parallel-worlds-for-physics-and-chemistry"> <a href="#parallel-worlds-for-physics-and-chemistry" class="anchor-heading" aria-labelledby="parallel-worlds-for-physics-and-chemistry"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Parallel Worlds for Physics and Chemistry </h3> <p>In the implementation, the physics geometry is implemented in a parallel world, while the chemistry executes in the primary Geant4 world which contains only water.</p> <p>This means the chemistry itself never needs to react with a DNA Geant4 geometry, as the DNA geometry is in the parallel world. Instead the chemistry interacts with the DNA geometry via a seperate memory structure associated with the mother placement volume.</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Built using <a href="https://github.com/pmarsceill/just-the-docs">Just The Docs</a>.</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
